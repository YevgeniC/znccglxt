<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
        <mapper namespace="se.zust.dao.LibraryDao">
         <!-- 配置resultMap属性，进行表字段与实体类属性映射 -->
    <resultMap id="LibraryMap" type="se.zust.entity.Library" >
        <id column="Libraryid" property="pid"  />
	    <result column="pnum" property="pnum"  />
	    <result column="pname" property="pname"  />
	    <result column="fisid" property="fisid" />
	    <result column="secid" property="secid"  />
	    <result column="thiid" property="thiid"  />
    </resultMap> 
    <resultMap id="SumMap" type="se.zust.entity.Library" >
	    <result column="pname" property="pname"  />
	 	<result column="SUM(pnum)" property="sum"   />
    </resultMap> 
    <insert id="addlibrary" parameterType="se.zust.entity.Library">
    	INSERT INTO library(pid,pnum,pname,fisid,secid,thiid) VALUES
    	(#{pid},#{pnum},#{pname},#{fisid},#{secid},#{thiid})
    
    </insert>  
    <select id="selectAlllibrary" resultMap="LibraryMap" resultType="se.zust.entity.Library">
        SELECT * FROM library limit #{nowpage},7
    </select>
    <select id="selectAlllibraryCount" resultType="Integer">
        SELECT COUNT(*) FROM library
    </select>
    <select id="sumlibrary" resultMap="SumMap">
        SELECT pname,SUM(pnum) FROM library GROUP BY pname limit #{nowpage},7
    </select>
    <select id="sumlibraryCount" resultType="Integer">
        Select count(*) FROM(SELECT IFNULL(COUNT(*),0) FROM library GROUP BY pname) as a
    </select>
    <select id="selectByPname" resultMap="LibraryMap" resultType="se.zust.entity.Library">
        SELECT * FROM library WHERE pname=#{0} limit #{1},7
    </select>
    <select id="selectByPnameCount" parameterType="string" resultType="Integer">
        SELECT IFNULL(COUNT(*),0) FROM library WHERE pname=#{pname}
    </select>
    <select id="selectByThidSecid" resultMap="LibraryMap" resultType="se.zust.entity.Library">
        SELECT * FROM library WHERE thiid=#{0} AND secid=#{1} limit #{2},7
    </select>
    <select id="selectByThidSecidCount" parameterType="string" resultType="Integer">
        SELECT IFNULL(COUNT(*),0) FROM library WHERE thiid=#{0} AND secid=#{1}
    </select>
    <select id="selectByID" parameterType="Integer" resultMap="LibraryMap" >
        SELECT * FROM library WHERE pid=#{pid}
    </select>
    <select id="selectByLocation" resultMap="LibraryMap" resultType="se.zust.entity.Library">
        SELECT * FROM library WHERE thiid=#{0} AND secid=#{1} AND fisid=#{2}
    </select>
    <delete id="delLibrary" parameterType="Integer" >
    		DELETE FROM library WHERE pid=#{pid} 
    </delete>
    <update id="updateLibrary" parameterType="se.zust.entity.Library">
    	update library
    	set thiid=#{0},secid=#{1},fisid=#{2}
    	where pid=#{3}
    </update>
 </mapper>